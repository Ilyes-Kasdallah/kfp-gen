You are an MLOps engineer. Write a Kubeflow pipeline based on the following description and code logic:

#load data from S3 #Use KFP UI for simple EDA #Split test data #Split val data #preprocess all datasets