The following modules were not unloaded:
  (Use "module --force purge" to unload all):

  1) CCconfig        6)  ucx/1.14.1         11) flexiblas/3.3.1
  2) gentoo/2023     7)  libfabric/1.18.0   12) imkl/2023.2.0
  3) gcccore/.12.3   8)  pmix/4.2.4         13) StdEnv/2023
  4) gcc/12.3        9)  ucc/1.2.0
  5) hwloc/2.9.1     10) openmpi/4.1.5
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Requirement already satisfied: pip in /home/ilyes/ENV/lib/python3.12/site-packages (25.2)
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/transformers-4.40.2+computecanada-py3-none-any.whl
Requirement already satisfied: accelerate>=0.29 in /home/ilyes/ENV/lib/python3.12/site-packages (1.1.1+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic/tokenizers-0.19.1+computecanada-cp312-cp312-linux_x86_64.whl
Requirement already satisfied: torch in /home/ilyes/ENV/lib/python3.12/site-packages (2.5.1+computecanada)
Requirement already satisfied: numpy>=1.26.4 in /home/ilyes/ENV/lib/python3.12/site-packages (2.2.2+computecanada)
Requirement already satisfied: nltk>=3.8 in /home/ilyes/ENV/lib/python3.12/site-packages (3.9.1+computecanada)
Requirement already satisfied: pylint>=3.0 in /home/ilyes/ENV/lib/python3.12/site-packages (3.0.3+computecanada)
Collecting kfp>=2.5
  Using cached kfp-2.14.2-py3-none-any.whl.metadata (4.3 kB)
Requirement already satisfied: filelock in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (3.18.0+computecanada)
Requirement already satisfied: huggingface-hub<1.0,>=0.19.3 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (0.27.1+computecanada)
Requirement already satisfied: packaging>=20.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (25.0+computecanada)
Requirement already satisfied: pyyaml>=5.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (6.0.2+computecanada)
Requirement already satisfied: regex!=2019.12.17 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (2024.9.11+computecanada)
Requirement already satisfied: requests in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (2.32.3+computecanada)
Requirement already satisfied: safetensors>=0.4.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (0.4.5+computecanada)
Requirement already satisfied: tqdm>=4.27 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (4.67.1+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic/numpy-1.26.4+computecanada-cp312-cp312-linux_x86_64.whl
Requirement already satisfied: fsspec>=2023.5.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from huggingface-hub<1.0,>=0.19.3->transformers==4.40.2) (2024.9.0+computecanada)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /home/ilyes/ENV/lib/python3.12/site-packages (from huggingface-hub<1.0,>=0.19.3->transformers==4.40.2) (4.12.2+computecanada)
Requirement already satisfied: psutil in /home/ilyes/ENV/lib/python3.12/site-packages (from accelerate>=0.29) (6.1.1+computecanada)
Requirement already satisfied: setuptools in /home/ilyes/ENV/lib/python3.12/site-packages (from torch) (75.6.0+computecanada)
Requirement already satisfied: sympy==1.13.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from torch) (1.13.1+computecanada)
Requirement already satisfied: networkx in /home/ilyes/ENV/lib/python3.12/site-packages (from torch) (3.4.2+computecanada)
Requirement already satisfied: jinja2 in /home/ilyes/ENV/lib/python3.12/site-packages (from torch) (3.1.5+computecanada)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from sympy==1.13.1->torch) (1.3.0+computecanada)
Requirement already satisfied: click in /home/ilyes/ENV/lib/python3.12/site-packages (from nltk>=3.8) (8.2.1+computecanada)
Requirement already satisfied: joblib in /home/ilyes/ENV/lib/python3.12/site-packages (from nltk>=3.8) (1.5.1+computecanada)
Requirement already satisfied: platformdirs>=2.2.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/ipykernel/2025a/lib/python3.12/site-packages (from pylint>=3.0) (4.3.6+computecanada)
Requirement already satisfied: astroid<=3.1.0-dev0,>=3.0.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from pylint>=3.0) (3.0.3+computecanada)
Requirement already satisfied: isort!=5.13.0,<6,>=4.2.5 in /home/ilyes/ENV/lib/python3.12/site-packages (from pylint>=3.0) (5.13.2+computecanada)
Requirement already satisfied: mccabe<0.8,>=0.6 in /home/ilyes/ENV/lib/python3.12/site-packages (from pylint>=3.0) (0.7.0+computecanada)
Requirement already satisfied: tomlkit>=0.10.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from pylint>=3.0) (0.13.3+computecanada)
Requirement already satisfied: dill>=0.3.6 in /home/ilyes/ENV/lib/python3.12/site-packages (from pylint>=3.0) (0.3.8+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/click-8.1.8+computecanada-py3-none-any.whl (from nltk>=3.8)
Collecting click-option-group==0.5.7 (from kfp>=2.5)
  Using cached click_option_group-0.5.7-py3-none-any.whl.metadata (5.8 kB)
Collecting docstring-parser<1,>=0.7.3 (from kfp>=2.5)
  Using cached docstring_parser-0.17.0-py3-none-any.whl.metadata (3.5 kB)
Collecting google-api-core!=2.0.*,!=2.1.*,!=2.2.*,!=2.3.0,<3.0.0dev,>=1.31.5 (from kfp>=2.5)
  Using cached google_api_core-2.25.1-py3-none-any.whl.metadata (3.0 kB)
Collecting google-auth<3,>=1.6.1 (from kfp>=2.5)
  Using cached google_auth-2.40.3-py2.py3-none-any.whl.metadata (6.2 kB)
Collecting google-cloud-storage<4,>=2.2.1 (from kfp>=2.5)
  Using cached google_cloud_storage-3.2.0-py3-none-any.whl.metadata (13 kB)
Collecting kfp-pipeline-spec==2.14.0 (from kfp>=2.5)
  Using cached kfp_pipeline_spec-2.14.0-py3-none-any.whl.metadata (433 bytes)
Collecting kfp-server-api<3,>=2.14.0 (from kfp>=2.5)
  Using cached kfp_server_api-2.14.0.tar.gz (64 kB)
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Getting requirements to build wheel: started
  Getting requirements to build wheel: finished with status 'done'
  Preparing metadata (pyproject.toml): started
  Preparing metadata (pyproject.toml): finished with status 'done'
Collecting kubernetes<31,>=8.0.0 (from kfp>=2.5)
  Using cached kubernetes-30.1.0-py2.py3-none-any.whl.metadata (1.5 kB)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3/protobuf-6.31.1+computecanada-cp312-cp312-linux_x86_64.whl (from kfp>=2.5)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/requests_toolbelt-1.0.0+computecanada-py2.py3-none-any.whl (from kfp>=2.5)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/tabulate-0.9.0+computecanada-py3-none-any.whl (from kfp>=2.5)
Requirement already satisfied: urllib3<3.0.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp>=2.5) (2.3.0+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/googleapis_common_protos-1.70.0+computecanada-py3-none-any.whl (from google-api-core!=2.0.*,!=2.1.*,!=2.2.*,!=2.3.0,<3.0.0dev,>=1.31.5->kfp>=2.5)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/proto_plus-1.26.1+computecanada-py3-none-any.whl (from google-api-core!=2.0.*,!=2.1.*,!=2.2.*,!=2.3.0,<3.0.0dev,>=1.31.5->kfp>=2.5)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/cachetools-5.5.2+computecanada-py3-none-any.whl (from google-auth<3,>=1.6.1->kfp>=2.5)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/pyasn1_modules-0.4.2+computecanada-py3-none-any.whl (from google-auth<3,>=1.6.1->kfp>=2.5)
Collecting rsa<5,>=3.1.4 (from google-auth<3,>=1.6.1->kfp>=2.5)
  Using cached rsa-4.9.1-py3-none-any.whl.metadata (5.6 kB)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/google_cloud_core-2.4.3+computecanada-py2.py3-none-any.whl (from google-cloud-storage<4,>=2.2.1->kfp>=2.5)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/google_resumable_media-2.7.2+computecanada-py2.py3-none-any.whl (from google-cloud-storage<4,>=2.2.1->kfp>=2.5)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/google_crc32c-1.6.0+computecanada-cp312-cp312-linux_x86_64.whl (from google-cloud-storage<4,>=2.2.1->kfp>=2.5)
Requirement already satisfied: six>=1.10 in /cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/scipy-stack/2025a/lib/python3.12/site-packages (from kfp-server-api<3,>=2.14.0->kfp>=2.5) (1.17.0+computecanada)
Requirement already satisfied: certifi in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp-server-api<3,>=2.14.0->kfp>=2.5) (2025.7.14+computecanada)
Requirement already satisfied: python-dateutil in /cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/scipy-stack/2025a/lib/python3.12/site-packages (from kfp-server-api<3,>=2.14.0->kfp>=2.5) (2.9.0.post0+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/websocket_client-1.8.0+computecanada-py3-none-any.whl (from kubernetes<31,>=8.0.0->kfp>=2.5)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/requests_oauthlib-2.0.0+computecanada-py2.py3-none-any.whl (from kubernetes<31,>=8.0.0->kfp>=2.5)
Collecting oauthlib>=3.2.2 (from kubernetes<31,>=8.0.0->kfp>=2.5)
  Using cached oauthlib-3.3.1-py3-none-any.whl.metadata (7.9 kB)
Requirement already satisfied: charset-normalizer<4,>=2 in /home/ilyes/ENV/lib/python3.12/site-packages (from requests->transformers==4.40.2) (3.4.2+computecanada)
Requirement already satisfied: idna<4,>=2.5 in /home/ilyes/ENV/lib/python3.12/site-packages (from requests->transformers==4.40.2) (3.10+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/pyasn1-0.6.1+computecanada-py3-none-any.whl (from rsa<5,>=3.1.4->google-auth<3,>=1.6.1->kfp>=2.5)
Requirement already satisfied: MarkupSafe>=2.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from jinja2->torch) (3.0.2+computecanada)
Downloading kfp-2.14.2-py3-none-any.whl (373 kB)
Downloading click_option_group-0.5.7-py3-none-any.whl (11 kB)
Downloading kfp_pipeline_spec-2.14.0-py3-none-any.whl (9.6 kB)
Downloading docstring_parser-0.17.0-py3-none-any.whl (36 kB)
Downloading google_api_core-2.25.1-py3-none-any.whl (160 kB)
Downloading google_auth-2.40.3-py2.py3-none-any.whl (216 kB)
Downloading google_cloud_storage-3.2.0-py3-none-any.whl (176 kB)
Downloading kubernetes-30.1.0-py2.py3-none-any.whl (1.7 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.7/1.7 MB 28.5 MB/s  0:00:00
Downloading rsa-4.9.1-py3-none-any.whl (34 kB)
Downloading oauthlib-3.3.1-py3-none-any.whl (160 kB)
Building wheels for collected packages: kfp-server-api
  Building wheel for kfp-server-api (pyproject.toml): started
  Building wheel for kfp-server-api (pyproject.toml): finished with status 'done'
  Created wheel for kfp-server-api: filename=kfp_server_api-2.14.0-py3-none-any.whl size=115810 sha256=f06e3b72ca5aba590a6ad0fa7434f6dbaff800cb5442fb5eced2fd0062623733
  Stored in directory: /home/ilyes/.cache/pip/wheels/f6/d1/63/0a25bf5f05bd1836944a1a5308d92e82f4d5cc3f11ac15a8ed
Successfully built kfp-server-api
Installing collected packages: websocket-client, tabulate, pyasn1, protobuf, oauthlib, numpy, google-crc32c, docstring-parser, click, cachetools, rsa, requests-toolbelt, requests-oauthlib, pyasn1-modules, proto-plus, kfp-server-api, kfp-pipeline-spec, googleapis-common-protos, google-resumable-media, click-option-group, tokenizers, google-auth, transformers, kubernetes, google-api-core, google-cloud-core, google-cloud-storage, kfp
  Attempting uninstall: protobuf
    Found existing installation: protobuf 5.29.3+computecanada
    Uninstalling protobuf-5.29.3+computecanada:
      Successfully uninstalled protobuf-5.29.3+computecanada
  Attempting uninstall: numpy
    Found existing installation: numpy 2.2.2+computecanada
    Uninstalling numpy-2.2.2+computecanada:
      Successfully uninstalled numpy-2.2.2+computecanada
  Attempting uninstall: click
    Found existing installation: click 8.2.1+computecanada
    Uninstalling click-8.2.1+computecanada:
      Successfully uninstalled click-8.2.1+computecanada
  Attempting uninstall: tokenizers
    Found existing installation: tokenizers 0.21.0+computecanada
    Uninstalling tokenizers-0.21.0+computecanada:
      Successfully uninstalled tokenizers-0.21.0+computecanada
  Attempting uninstall: transformers
    Found existing installation: transformers 4.48.0+computecanada
    Uninstalling transformers-4.48.0+computecanada:
      Successfully uninstalled transformers-4.48.0+computecanada

ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
wandb 0.18.7+computecanada requires protobuf!=4.21.0,!=5.28.0,<6,>=3.19.0; python_version > "3.9" and sys_platform == "linux", but you have protobuf 6.31.1+computecanada which is incompatible.
trl 0.12.1+computecanada requires transformers>=4.46.0, but you have transformers 4.40.2+computecanada which is incompatible.
Successfully installed cachetools-5.5.2+computecanada click-8.1.8+computecanada click-option-group-0.5.7 docstring-parser-0.17.0 google-api-core-2.25.1 google-auth-2.40.3 google-cloud-core-2.4.3+computecanada google-cloud-storage-3.2.0 google-crc32c-1.6.0+computecanada google-resumable-media-2.7.2+computecanada googleapis-common-protos-1.70.0+computecanada kfp-2.14.2 kfp-pipeline-spec-2.14.0 kfp-server-api-2.14.0 kubernetes-30.1.0 numpy-1.26.4+computecanada oauthlib-3.3.1 proto-plus-1.26.1+computecanada protobuf-6.31.1+computecanada pyasn1-0.6.1+computecanada pyasn1-modules-0.4.2+computecanada requests-oauthlib-2.0.0+computecanada requests-toolbelt-1.0.0+computecanada rsa-4.9.1 tabulate-0.9.0+computecanada tokenizers-0.19.1+computecanada transformers-4.40.2+computecanada websocket-client-1.8.0+computecanada
Traceback (most recent call last):
  File "/home/ilyes/ENV/lib/python3.12/site-packages/transformers/utils/hub.py", line 398, in cached_file
    resolved_file = hf_hub_download(
                    ^^^^^^^^^^^^^^^^
  File "/home/ilyes/ENV/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 106, in _inner_fn
    validate_repo_id(arg_value)
  File "/home/ilyes/ENV/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 154, in validate_repo_id
    raise HFValidationError(
huggingface_hub.errors.HFValidationError: Repo id must be in the form 'repo_name' or 'namespace/repo_name': '/scratch/ilyes/kfp-gen/finetuning/output/qwen-finetuned'. Use `repo_type` argument if needed.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/scratch/ilyes/kfp-gen/finetuning/test_qwen/./eval.py", line 328, in <module>
    main()
  File "/scratch/ilyes/kfp-gen/finetuning/test_qwen/./eval.py", line 236, in main
    tok, model = load_model(args.model_path)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/ilyes/kfp-gen/finetuning/test_qwen/./eval.py", line 77, in load_model
    tok = AutoTokenizer.from_pretrained(model_path, trust_remote_code=True)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ilyes/ENV/lib/python3.12/site-packages/transformers/models/auto/tokenization_auto.py", line 804, in from_pretrained
    tokenizer_config = get_tokenizer_config(pretrained_model_name_or_path, **kwargs)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ilyes/ENV/lib/python3.12/site-packages/transformers/models/auto/tokenization_auto.py", line 637, in get_tokenizer_config
    resolved_config_file = cached_file(
                           ^^^^^^^^^^^^
  File "/home/ilyes/ENV/lib/python3.12/site-packages/transformers/utils/hub.py", line 462, in cached_file
    raise EnvironmentError(
OSError: Incorrect path_or_model_id: '/scratch/ilyes/kfp-gen/finetuning/output/qwen-finetuned'. Please provide either the path to a local folder or the repo_id of a model on the Hub.
