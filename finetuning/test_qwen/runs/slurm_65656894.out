The following modules were not unloaded:
  (Use "module --force purge" to unload all):

  1) CCconfig        6)  ucx/1.14.1         11) flexiblas/3.3.1
  2) gentoo/2023     7)  libfabric/1.18.0   12) imkl/2023.2.0
  3) gcccore/.12.3   8)  pmix/4.2.4         13) StdEnv/2023
  4) gcc/12.3        9)  ucc/1.2.0
  5) hwloc/2.9.1     10) openmpi/4.1.5
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Requirement already satisfied: pip in /home/ilyes/ENV/lib/python3.12/site-packages (25.2)
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Requirement already satisfied: transformers==4.40.2 in /home/ilyes/ENV/lib/python3.12/site-packages (4.40.2+computecanada)
Requirement already satisfied: accelerate>=0.29 in /home/ilyes/ENV/lib/python3.12/site-packages (1.1.1+computecanada)
Requirement already satisfied: tokenizers<0.20 in /home/ilyes/ENV/lib/python3.12/site-packages (0.19.1+computecanada)
Requirement already satisfied: torch in /home/ilyes/ENV/lib/python3.12/site-packages (2.5.1+computecanada)
Requirement already satisfied: numpy>=1.26.4 in /home/ilyes/ENV/lib/python3.12/site-packages (1.26.4+computecanada)
Requirement already satisfied: nltk>=3.8 in /home/ilyes/ENV/lib/python3.12/site-packages (3.9.1+computecanada)
Requirement already satisfied: pylint>=3.0 in /home/ilyes/ENV/lib/python3.12/site-packages (3.0.3+computecanada)
Requirement already satisfied: kfp>=2.5 in /home/ilyes/ENV/lib/python3.12/site-packages (2.14.2)
Requirement already satisfied: filelock in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (3.18.0+computecanada)
Requirement already satisfied: huggingface-hub<1.0,>=0.19.3 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (0.27.1+computecanada)
Requirement already satisfied: packaging>=20.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (25.0+computecanada)
Requirement already satisfied: pyyaml>=5.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (6.0.2+computecanada)
Requirement already satisfied: regex!=2019.12.17 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (2024.9.11+computecanada)
Requirement already satisfied: requests in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (2.32.3+computecanada)
Requirement already satisfied: safetensors>=0.4.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (0.4.5+computecanada)
Requirement already satisfied: tqdm>=4.27 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (4.67.1+computecanada)
Requirement already satisfied: fsspec>=2023.5.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from huggingface-hub<1.0,>=0.19.3->transformers==4.40.2) (2024.9.0+computecanada)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /home/ilyes/ENV/lib/python3.12/site-packages (from huggingface-hub<1.0,>=0.19.3->transformers==4.40.2) (4.12.2+computecanada)
Requirement already satisfied: psutil in /home/ilyes/ENV/lib/python3.12/site-packages (from accelerate>=0.29) (6.1.1+computecanada)
Requirement already satisfied: setuptools in /home/ilyes/ENV/lib/python3.12/site-packages (from torch) (75.6.0+computecanada)
Requirement already satisfied: sympy==1.13.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from torch) (1.13.1+computecanada)
Requirement already satisfied: networkx in /home/ilyes/ENV/lib/python3.12/site-packages (from torch) (3.4.2+computecanada)
Requirement already satisfied: jinja2 in /home/ilyes/ENV/lib/python3.12/site-packages (from torch) (3.1.5+computecanada)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from sympy==1.13.1->torch) (1.3.0+computecanada)
Requirement already satisfied: click in /home/ilyes/ENV/lib/python3.12/site-packages (from nltk>=3.8) (8.1.8+computecanada)
Requirement already satisfied: joblib in /home/ilyes/ENV/lib/python3.12/site-packages (from nltk>=3.8) (1.5.1+computecanada)
Requirement already satisfied: platformdirs>=2.2.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/ipykernel/2025a/lib/python3.12/site-packages (from pylint>=3.0) (4.3.6+computecanada)
Requirement already satisfied: astroid<=3.1.0-dev0,>=3.0.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from pylint>=3.0) (3.0.3+computecanada)
Requirement already satisfied: isort!=5.13.0,<6,>=4.2.5 in /home/ilyes/ENV/lib/python3.12/site-packages (from pylint>=3.0) (5.13.2+computecanada)
Requirement already satisfied: mccabe<0.8,>=0.6 in /home/ilyes/ENV/lib/python3.12/site-packages (from pylint>=3.0) (0.7.0+computecanada)
Requirement already satisfied: tomlkit>=0.10.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from pylint>=3.0) (0.13.3+computecanada)
Requirement already satisfied: dill>=0.3.6 in /home/ilyes/ENV/lib/python3.12/site-packages (from pylint>=3.0) (0.3.8+computecanada)
Requirement already satisfied: click-option-group==0.5.7 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp>=2.5) (0.5.7)
Requirement already satisfied: docstring-parser<1,>=0.7.3 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp>=2.5) (0.17.0)
Requirement already satisfied: google-api-core!=2.0.*,!=2.1.*,!=2.2.*,!=2.3.0,<3.0.0dev,>=1.31.5 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp>=2.5) (2.25.1)
Requirement already satisfied: google-auth<3,>=1.6.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp>=2.5) (2.40.3)
Requirement already satisfied: google-cloud-storage<4,>=2.2.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp>=2.5) (3.2.0)
Requirement already satisfied: kfp-pipeline-spec==2.14.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp>=2.5) (2.14.0)
Requirement already satisfied: kfp-server-api<3,>=2.14.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp>=2.5) (2.14.0)
Requirement already satisfied: kubernetes<31,>=8.0.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp>=2.5) (30.1.0)
Requirement already satisfied: protobuf<7.0,==6.31.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp>=2.5) (6.31.1+computecanada)
Requirement already satisfied: requests-toolbelt<2,>=0.8.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp>=2.5) (1.0.0+computecanada)
Requirement already satisfied: tabulate<1,>=0.8.6 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp>=2.5) (0.9.0+computecanada)
Requirement already satisfied: urllib3<3.0.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp>=2.5) (2.3.0+computecanada)
Requirement already satisfied: googleapis-common-protos<2.0.0,>=1.56.2 in /home/ilyes/ENV/lib/python3.12/site-packages (from google-api-core!=2.0.*,!=2.1.*,!=2.2.*,!=2.3.0,<3.0.0dev,>=1.31.5->kfp>=2.5) (1.70.0+computecanada)
Requirement already satisfied: proto-plus<2.0.0,>=1.22.3 in /home/ilyes/ENV/lib/python3.12/site-packages (from google-api-core!=2.0.*,!=2.1.*,!=2.2.*,!=2.3.0,<3.0.0dev,>=1.31.5->kfp>=2.5) (1.26.1+computecanada)
Requirement already satisfied: cachetools<6.0,>=2.0.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from google-auth<3,>=1.6.1->kfp>=2.5) (5.5.2+computecanada)
Requirement already satisfied: pyasn1-modules>=0.2.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from google-auth<3,>=1.6.1->kfp>=2.5) (0.4.2+computecanada)
Requirement already satisfied: rsa<5,>=3.1.4 in /home/ilyes/ENV/lib/python3.12/site-packages (from google-auth<3,>=1.6.1->kfp>=2.5) (4.9.1)
Requirement already satisfied: google-cloud-core<3.0.0,>=2.4.2 in /home/ilyes/ENV/lib/python3.12/site-packages (from google-cloud-storage<4,>=2.2.1->kfp>=2.5) (2.4.3+computecanada)
Requirement already satisfied: google-resumable-media<3.0.0,>=2.7.2 in /home/ilyes/ENV/lib/python3.12/site-packages (from google-cloud-storage<4,>=2.2.1->kfp>=2.5) (2.7.2+computecanada)
Requirement already satisfied: google-crc32c<2.0.0,>=1.1.3 in /home/ilyes/ENV/lib/python3.12/site-packages (from google-cloud-storage<4,>=2.2.1->kfp>=2.5) (1.6.0+computecanada)
Requirement already satisfied: six>=1.10 in /cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/scipy-stack/2025a/lib/python3.12/site-packages (from kfp-server-api<3,>=2.14.0->kfp>=2.5) (1.17.0+computecanada)
Requirement already satisfied: certifi in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp-server-api<3,>=2.14.0->kfp>=2.5) (2025.7.14+computecanada)
Requirement already satisfied: python-dateutil in /cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/scipy-stack/2025a/lib/python3.12/site-packages (from kfp-server-api<3,>=2.14.0->kfp>=2.5) (2.9.0.post0+computecanada)
Requirement already satisfied: websocket-client!=0.40.0,!=0.41.*,!=0.42.*,>=0.32.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from kubernetes<31,>=8.0.0->kfp>=2.5) (1.8.0+computecanada)
Requirement already satisfied: requests-oauthlib in /home/ilyes/ENV/lib/python3.12/site-packages (from kubernetes<31,>=8.0.0->kfp>=2.5) (2.0.0+computecanada)
Requirement already satisfied: oauthlib>=3.2.2 in /home/ilyes/ENV/lib/python3.12/site-packages (from kubernetes<31,>=8.0.0->kfp>=2.5) (3.3.1)
Requirement already satisfied: charset-normalizer<4,>=2 in /home/ilyes/ENV/lib/python3.12/site-packages (from requests->transformers==4.40.2) (3.4.2+computecanada)
Requirement already satisfied: idna<4,>=2.5 in /home/ilyes/ENV/lib/python3.12/site-packages (from requests->transformers==4.40.2) (3.10+computecanada)
Requirement already satisfied: pyasn1>=0.1.3 in /home/ilyes/ENV/lib/python3.12/site-packages (from rsa<5,>=3.1.4->google-auth<3,>=1.6.1->kfp>=2.5) (0.6.1+computecanada)
Requirement already satisfied: MarkupSafe>=2.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from jinja2->torch) (3.0.2+computecanada)
Traceback (most recent call last):
  File "/scratch/ilyes/kfp-gen/finetuning/test_qwen/./eval.py", line 328, in <module>
    main()
  File "/scratch/ilyes/kfp-gen/finetuning/test_qwen/./eval.py", line 236, in main
    tok, model = load_model(args.model_path)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/ilyes/kfp-gen/finetuning/test_qwen/./eval.py", line 77, in load_model
    tok = AutoTokenizer.from_pretrained(model_path, trust_remote_code=True)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ilyes/ENV/lib/python3.12/site-packages/transformers/models/auto/tokenization_auto.py", line 862, in from_pretrained
    return tokenizer_class.from_pretrained(pretrained_model_name_or_path, *inputs, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ilyes/ENV/lib/python3.12/site-packages/transformers/tokenization_utils_base.py", line 2089, in from_pretrained
    return cls._from_pretrained(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/ilyes/ENV/lib/python3.12/site-packages/transformers/tokenization_utils_base.py", line 2311, in _from_pretrained
    tokenizer = cls(*init_inputs, **init_kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ilyes/ENV/lib/python3.12/site-packages/transformers/models/qwen2/tokenization_qwen2_fast.py", line 120, in __init__
    super().__init__(
  File "/home/ilyes/ENV/lib/python3.12/site-packages/transformers/tokenization_utils_fast.py", line 111, in __init__
    fast_tokenizer = TokenizerFast.from_file(fast_tokenizer_file)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Exception: data did not match any variant of untagged enum ModelWrapper at line 757443 column 3
