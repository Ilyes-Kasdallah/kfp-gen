The following modules were not unloaded:
  (Use "module --force purge" to unload all):

  1) CCconfig        6)  ucx/1.14.1         11) flexiblas/3.3.1
  2) gentoo/2023     7)  libfabric/1.18.0   12) imkl/2023.2.0
  3) gcccore/.12.3   8)  pmix/4.2.4         13) StdEnv/2023
  4) gcc/12.3        9)  ucc/1.2.0
  5) hwloc/2.9.1     10) openmpi/4.1.5
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Requirement already satisfied: pip in /home/ilyes/ENV/lib/python3.12/site-packages (25.2)
Requirement already satisfied: setuptools in /home/ilyes/ENV/lib/python3.12/site-packages (80.9.0+computecanada)
Requirement already satisfied: wheel in /home/ilyes/ENV/lib/python3.12/site-packages (0.45.1+computecanada)
WARNING: Skipping wandb as it is not installed.
Found existing installation: protobuf 6.31.1+computecanada
Uninstalling protobuf-6.31.1+computecanada:
  Successfully uninstalled protobuf-6.31.1+computecanada
Found existing installation: tokenizers 0.19.1+computecanada
Uninstalling tokenizers-0.19.1+computecanada:
  Successfully uninstalled tokenizers-0.19.1+computecanada
Found existing installation: transformers 4.40.2+computecanada
Uninstalling transformers-4.40.2+computecanada:
  Successfully uninstalled transformers-4.40.2+computecanada
Found existing installation: kfp 2.14.2
Uninstalling kfp-2.14.2:
  Successfully uninstalled kfp-2.14.2
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/transformers-4.40.2+computecanada-py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic/tokenizers-0.19.1+computecanada-cp312-cp312-linux_x86_64.whl
Requirement already satisfied: accelerate>=0.29 in /home/ilyes/ENV/lib/python3.12/site-packages (1.1.1+computecanada)
Requirement already satisfied: torch in /home/ilyes/ENV/lib/python3.12/site-packages (2.5.1+computecanada)
Requirement already satisfied: numpy<2,>=1.26.4 in /home/ilyes/ENV/lib/python3.12/site-packages (1.26.4+computecanada)
Requirement already satisfied: nltk>=3.8 in /home/ilyes/ENV/lib/python3.12/site-packages (3.9.1+computecanada)
Requirement already satisfied: pylint>=3.0 in /home/ilyes/ENV/lib/python3.12/site-packages (3.0.3+computecanada)
Requirement already satisfied: datasets<3,>=2.18 in /home/ilyes/ENV/lib/python3.12/site-packages (2.21.0+computecanada)
Requirement already satisfied: filelock in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (3.18.0+computecanada)
Requirement already satisfied: huggingface-hub<1.0,>=0.19.3 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (0.27.1+computecanada)
Requirement already satisfied: packaging>=20.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (24.2+computecanada)
Requirement already satisfied: pyyaml>=5.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (6.0.2+computecanada)
Requirement already satisfied: regex!=2019.12.17 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (2024.9.11+computecanada)
Requirement already satisfied: requests in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (2.32.3+computecanada)
Requirement already satisfied: safetensors>=0.4.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (0.4.5+computecanada)
Requirement already satisfied: tqdm>=4.27 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (4.67.1+computecanada)
Requirement already satisfied: pyarrow>=15.0.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/arrow/19.0.1/lib/python3.12/site-packages (from datasets<3,>=2.18) (19.0.1)
Requirement already satisfied: dill<0.3.9,>=0.3.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from datasets<3,>=2.18) (0.3.8+computecanada)
Requirement already satisfied: pandas in /home/ilyes/ENV/lib/python3.12/site-packages (from datasets<3,>=2.18) (2.2.3+computecanada)
Requirement already satisfied: xxhash in /home/ilyes/ENV/lib/python3.12/site-packages (from datasets<3,>=2.18) (3.5.0+computecanada)
Requirement already satisfied: multiprocess in /home/ilyes/ENV/lib/python3.12/site-packages (from datasets<3,>=2.18) (0.70.16+computecanada)
Requirement already satisfied: fsspec<=2024.6.1,>=2023.1.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from fsspec[http]<=2024.6.1,>=2023.1.0->datasets<3,>=2.18) (2024.6.1+computecanada)
Requirement already satisfied: aiohttp in /home/ilyes/ENV/lib/python3.12/site-packages (from datasets<3,>=2.18) (3.12.13+computecanada)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /home/ilyes/ENV/lib/python3.12/site-packages (from huggingface-hub<1.0,>=0.19.3->transformers==4.40.2) (4.12.2+computecanada)
Requirement already satisfied: psutil in /home/ilyes/ENV/lib/python3.12/site-packages (from accelerate>=0.29) (6.1.1+computecanada)
Requirement already satisfied: setuptools in /home/ilyes/ENV/lib/python3.12/site-packages (from torch) (80.9.0+computecanada)
Requirement already satisfied: sympy==1.13.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from torch) (1.13.1+computecanada)
Requirement already satisfied: networkx in /home/ilyes/ENV/lib/python3.12/site-packages (from torch) (3.4.2+computecanada)
Requirement already satisfied: jinja2 in /home/ilyes/ENV/lib/python3.12/site-packages (from torch) (3.1.5+computecanada)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from sympy==1.13.1->torch) (1.3.0+computecanada)
Requirement already satisfied: click in /home/ilyes/ENV/lib/python3.12/site-packages (from nltk>=3.8) (8.1.8+computecanada)
Requirement already satisfied: joblib in /home/ilyes/ENV/lib/python3.12/site-packages (from nltk>=3.8) (1.5.1+computecanada)
Requirement already satisfied: platformdirs>=2.2.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/ipykernel/2025a/lib/python3.12/site-packages (from pylint>=3.0) (4.3.6+computecanada)
Requirement already satisfied: astroid<=3.1.0-dev0,>=3.0.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from pylint>=3.0) (3.0.3+computecanada)
Requirement already satisfied: isort!=5.13.0,<6,>=4.2.5 in /home/ilyes/ENV/lib/python3.12/site-packages (from pylint>=3.0) (5.13.2+computecanada)
Requirement already satisfied: mccabe<0.8,>=0.6 in /home/ilyes/ENV/lib/python3.12/site-packages (from pylint>=3.0) (0.7.0+computecanada)
Requirement already satisfied: tomlkit>=0.10.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from pylint>=3.0) (0.13.3+computecanada)
Requirement already satisfied: aiohappyeyeballs>=2.5.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from aiohttp->datasets<3,>=2.18) (2.6.1+computecanada)
Requirement already satisfied: aiosignal>=1.1.2 in /home/ilyes/ENV/lib/python3.12/site-packages (from aiohttp->datasets<3,>=2.18) (1.4.0+computecanada)
Requirement already satisfied: attrs>=17.3.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from aiohttp->datasets<3,>=2.18) (25.3.0+computecanada)
Requirement already satisfied: frozenlist>=1.1.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from aiohttp->datasets<3,>=2.18) (1.7.0+computecanada)
Requirement already satisfied: multidict<7.0,>=4.5 in /home/ilyes/ENV/lib/python3.12/site-packages (from aiohttp->datasets<3,>=2.18) (6.1.0+computecanada)
Requirement already satisfied: propcache>=0.2.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from aiohttp->datasets<3,>=2.18) (0.2.1+computecanada)
Requirement already satisfied: yarl<2.0,>=1.17.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from aiohttp->datasets<3,>=2.18) (1.18.3+computecanada)
Requirement already satisfied: idna>=2.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from yarl<2.0,>=1.17.0->aiohttp->datasets<3,>=2.18) (3.10+computecanada)
Requirement already satisfied: charset-normalizer<4,>=2 in /home/ilyes/ENV/lib/python3.12/site-packages (from requests->transformers==4.40.2) (3.4.2+computecanada)
Requirement already satisfied: urllib3<3,>=1.21.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from requests->transformers==4.40.2) (2.3.0+computecanada)
Requirement already satisfied: certifi>=2017.4.17 in /home/ilyes/ENV/lib/python3.12/site-packages (from requests->transformers==4.40.2) (2025.7.14+computecanada)
Requirement already satisfied: MarkupSafe>=2.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from jinja2->torch) (3.0.2+computecanada)
Requirement already satisfied: python-dateutil>=2.8.2 in /home/ilyes/ENV/lib/python3.12/site-packages (from pandas->datasets<3,>=2.18) (2.9.0.post0+computecanada)
Requirement already satisfied: pytz>=2020.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from pandas->datasets<3,>=2.18) (2025.1+computecanada)
Requirement already satisfied: tzdata>=2022.7 in /home/ilyes/ENV/lib/python3.12/site-packages (from pandas->datasets<3,>=2.18) (2025.1+computecanada)
Requirement already satisfied: six>=1.5 in /home/ilyes/ENV/lib/python3.12/site-packages (from python-dateutil>=2.8.2->pandas->datasets<3,>=2.18) (1.17.0+computecanada)
Installing collected packages: tokenizers, transformers

Successfully installed tokenizers-0.19.1+computecanada transformers-4.40.2+computecanada
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3/protobuf-6.31.1+computecanada-cp312-cp312-linux_x86_64.whl
Collecting kfp==2.14.2
  Using cached kfp-2.14.2-py3-none-any.whl.metadata (4.3 kB)
Requirement already satisfied: click==8.1.8 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp==2.14.2) (8.1.8+computecanada)
Requirement already satisfied: click-option-group==0.5.7 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp==2.14.2) (0.5.7)
Requirement already satisfied: docstring-parser<1,>=0.7.3 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp==2.14.2) (0.17.0)
Requirement already satisfied: google-api-core!=2.0.*,!=2.1.*,!=2.2.*,!=2.3.0,<3.0.0dev,>=1.31.5 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp==2.14.2) (2.25.1)
Requirement already satisfied: google-auth<3,>=1.6.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp==2.14.2) (2.40.3)
Requirement already satisfied: google-cloud-storage<4,>=2.2.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp==2.14.2) (3.2.0)
Requirement already satisfied: kfp-pipeline-spec==2.14.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp==2.14.2) (2.14.0)
Requirement already satisfied: kfp-server-api<3,>=2.14.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp==2.14.2) (2.14.0)
Requirement already satisfied: kubernetes<31,>=8.0.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp==2.14.2) (30.1.0)
Requirement already satisfied: PyYAML<7,>=5.3 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp==2.14.2) (6.0.2+computecanada)
Requirement already satisfied: requests-toolbelt<2,>=0.8.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp==2.14.2) (1.0.0+computecanada)
Requirement already satisfied: tabulate<1,>=0.8.6 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp==2.14.2) (0.9.0+computecanada)
Requirement already satisfied: urllib3<3.0.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp==2.14.2) (2.3.0+computecanada)
Requirement already satisfied: googleapis-common-protos<2.0.0,>=1.56.2 in /home/ilyes/ENV/lib/python3.12/site-packages (from google-api-core!=2.0.*,!=2.1.*,!=2.2.*,!=2.3.0,<3.0.0dev,>=1.31.5->kfp==2.14.2) (1.70.0+computecanada)
Requirement already satisfied: proto-plus<2.0.0,>=1.22.3 in /home/ilyes/ENV/lib/python3.12/site-packages (from google-api-core!=2.0.*,!=2.1.*,!=2.2.*,!=2.3.0,<3.0.0dev,>=1.31.5->kfp==2.14.2) (1.26.1+computecanada)
Requirement already satisfied: requests<3.0.0,>=2.18.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from google-api-core!=2.0.*,!=2.1.*,!=2.2.*,!=2.3.0,<3.0.0dev,>=1.31.5->kfp==2.14.2) (2.32.3+computecanada)
Requirement already satisfied: cachetools<6.0,>=2.0.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from google-auth<3,>=1.6.1->kfp==2.14.2) (5.5.2+computecanada)
Requirement already satisfied: pyasn1-modules>=0.2.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from google-auth<3,>=1.6.1->kfp==2.14.2) (0.4.2+computecanada)
Requirement already satisfied: rsa<5,>=3.1.4 in /home/ilyes/ENV/lib/python3.12/site-packages (from google-auth<3,>=1.6.1->kfp==2.14.2) (4.9.1)
Requirement already satisfied: google-cloud-core<3.0.0,>=2.4.2 in /home/ilyes/ENV/lib/python3.12/site-packages (from google-cloud-storage<4,>=2.2.1->kfp==2.14.2) (2.4.3+computecanada)
Requirement already satisfied: google-resumable-media<3.0.0,>=2.7.2 in /home/ilyes/ENV/lib/python3.12/site-packages (from google-cloud-storage<4,>=2.2.1->kfp==2.14.2) (2.7.2+computecanada)
Requirement already satisfied: google-crc32c<2.0.0,>=1.1.3 in /home/ilyes/ENV/lib/python3.12/site-packages (from google-cloud-storage<4,>=2.2.1->kfp==2.14.2) (1.6.0+computecanada)
Requirement already satisfied: six>=1.10 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp-server-api<3,>=2.14.0->kfp==2.14.2) (1.17.0+computecanada)
Requirement already satisfied: certifi in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp-server-api<3,>=2.14.0->kfp==2.14.2) (2025.7.14+computecanada)
Requirement already satisfied: python-dateutil in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp-server-api<3,>=2.14.0->kfp==2.14.2) (2.9.0.post0+computecanada)
Requirement already satisfied: websocket-client!=0.40.0,!=0.41.*,!=0.42.*,>=0.32.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from kubernetes<31,>=8.0.0->kfp==2.14.2) (1.8.0+computecanada)
Requirement already satisfied: requests-oauthlib in /home/ilyes/ENV/lib/python3.12/site-packages (from kubernetes<31,>=8.0.0->kfp==2.14.2) (2.0.0+computecanada)
Requirement already satisfied: oauthlib>=3.2.2 in /home/ilyes/ENV/lib/python3.12/site-packages (from kubernetes<31,>=8.0.0->kfp==2.14.2) (3.3.1)
Requirement already satisfied: charset-normalizer<4,>=2 in /home/ilyes/ENV/lib/python3.12/site-packages (from requests<3.0.0,>=2.18.0->google-api-core!=2.0.*,!=2.1.*,!=2.2.*,!=2.3.0,<3.0.0dev,>=1.31.5->kfp==2.14.2) (3.4.2+computecanada)
Requirement already satisfied: idna<4,>=2.5 in /home/ilyes/ENV/lib/python3.12/site-packages (from requests<3.0.0,>=2.18.0->google-api-core!=2.0.*,!=2.1.*,!=2.2.*,!=2.3.0,<3.0.0dev,>=1.31.5->kfp==2.14.2) (3.10+computecanada)
Requirement already satisfied: pyasn1>=0.1.3 in /home/ilyes/ENV/lib/python3.12/site-packages (from rsa<5,>=3.1.4->google-auth<3,>=1.6.1->kfp==2.14.2) (0.6.1+computecanada)
Using cached kfp-2.14.2-py3-none-any.whl (373 kB)
Installing collected packages: protobuf, kfp

Successfully installed kfp-2.14.2 protobuf-6.31.1+computecanada
/home/ilyes/ENV/lib/python3.12/site-packages/google/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  __import__('pkg_resources').declare_namespace(__name__)
transformers: 4.40.2
tokenizers  : 0.19.1
protobuf    : 6.31.1
kfp         : 2.14.2
/home/ilyes/ENV/lib/python3.12/site-packages/google/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  __import__('pkg_resources').declare_namespace(__name__)
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:02<00:07,  2.37s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:04<00:04,  2.35s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:07<00:02,  2.33s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:09<00:00,  2.24s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:09<00:00,  2.28s/it]
CSV: /scratch/ilyes/kfp-gen/finetuning/testing_qwen/runs/exp1/results.csv
JSON: /scratch/ilyes/kfp-gen/finetuning/testing_qwen/runs/exp1/results.json
Gen: /scratch/ilyes/kfp-gen/finetuning/testing_qwen/runs/exp1/gen
YAML: /scratch/ilyes/kfp-gen/finetuning/testing_qwen/runs/exp1/yaml
Logs: /scratch/ilyes/kfp-gen/finetuning/testing_qwen/runs/exp1/logs
