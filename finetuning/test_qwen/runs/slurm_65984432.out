The following modules were not unloaded:
  (Use "module --force purge" to unload all):

  1) CCconfig        6)  ucx/1.14.1         11) flexiblas/3.3.1
  2) gentoo/2023     7)  libfabric/1.18.0   12) imkl/2023.2.0
  3) gcccore/.12.3   8)  pmix/4.2.4         13) StdEnv/2023
  4) gcc/12.3        9)  ucc/1.2.0
  5) hwloc/2.9.1     10) openmpi/4.1.5
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Requirement already satisfied: pip in /home/ilyes/ENV/lib/python3.12/site-packages (25.2)
Requirement already satisfied: setuptools in /home/ilyes/ENV/lib/python3.12/site-packages (80.9.0+computecanada)
Requirement already satisfied: wheel in /home/ilyes/ENV/lib/python3.12/site-packages (0.45.1+computecanada)
Found existing installation: trl 0.12.1+computecanada
Uninstalling trl-0.12.1+computecanada:
  Successfully uninstalled trl-0.12.1+computecanada
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3/protobuf-5.29.5+computecanada-cp312-cp312-linux_x86_64.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/transformers-4.40.2+computecanada-py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic/tokenizers-0.19.1+computecanada-cp312-cp312-linux_x86_64.whl
Requirement already satisfied: accelerate>=0.29 in /home/ilyes/ENV/lib/python3.12/site-packages (1.1.1+computecanada)
Requirement already satisfied: torch in /home/ilyes/ENV/lib/python3.12/site-packages (2.5.1+computecanada)
Requirement already satisfied: numpy<2,>=1.26.4 in /home/ilyes/ENV/lib/python3.12/site-packages (1.26.4+computecanada)
Requirement already satisfied: nltk>=3.8 in /home/ilyes/ENV/lib/python3.12/site-packages (3.9.1+computecanada)
Requirement already satisfied: pylint>=3.0 in /home/ilyes/ENV/lib/python3.12/site-packages (3.0.3+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/datasets-2.21.0+computecanada-py3-none-any.whl
Requirement already satisfied: kfp>=2.5 in /home/ilyes/ENV/lib/python3.12/site-packages (2.14.2)
Requirement already satisfied: filelock in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (3.18.0+computecanada)
Requirement already satisfied: huggingface-hub<1.0,>=0.19.3 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (0.27.1+computecanada)
Requirement already satisfied: packaging>=20.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (24.2+computecanada)
Requirement already satisfied: pyyaml>=5.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (6.0.2+computecanada)
Requirement already satisfied: regex!=2019.12.17 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (2024.9.11+computecanada)
Requirement already satisfied: requests in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (2.32.3+computecanada)
Requirement already satisfied: safetensors>=0.4.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (0.4.5+computecanada)
Requirement already satisfied: tqdm>=4.27 in /home/ilyes/ENV/lib/python3.12/site-packages (from transformers==4.40.2) (4.67.1+computecanada)
Requirement already satisfied: pyarrow>=15.0.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/arrow/19.0.1/lib/python3.12/site-packages (from datasets<3,>=2.18) (19.0.1)
Requirement already satisfied: dill<0.3.9,>=0.3.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from datasets<3,>=2.18) (0.3.8+computecanada)
Requirement already satisfied: pandas in /home/ilyes/ENV/lib/python3.12/site-packages (from datasets<3,>=2.18) (2.2.3+computecanada)
Requirement already satisfied: xxhash in /home/ilyes/ENV/lib/python3.12/site-packages (from datasets<3,>=2.18) (3.5.0+computecanada)
Requirement already satisfied: multiprocess in /home/ilyes/ENV/lib/python3.12/site-packages (from datasets<3,>=2.18) (0.70.16+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/fsspec-2024.6.1+computecanada-py3-none-any.whl (from fsspec[http]<=2024.6.1,>=2023.1.0->datasets<3,>=2.18)
Requirement already satisfied: aiohttp in /home/ilyes/ENV/lib/python3.12/site-packages (from datasets<3,>=2.18) (3.12.13+computecanada)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /home/ilyes/ENV/lib/python3.12/site-packages (from huggingface-hub<1.0,>=0.19.3->transformers==4.40.2) (4.12.2+computecanada)
Requirement already satisfied: psutil in /home/ilyes/ENV/lib/python3.12/site-packages (from accelerate>=0.29) (6.1.1+computecanada)
Requirement already satisfied: setuptools in /home/ilyes/ENV/lib/python3.12/site-packages (from torch) (80.9.0+computecanada)
Requirement already satisfied: sympy==1.13.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from torch) (1.13.1+computecanada)
Requirement already satisfied: networkx in /home/ilyes/ENV/lib/python3.12/site-packages (from torch) (3.4.2+computecanada)
Requirement already satisfied: jinja2 in /home/ilyes/ENV/lib/python3.12/site-packages (from torch) (3.1.5+computecanada)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from sympy==1.13.1->torch) (1.3.0+computecanada)
Requirement already satisfied: click in /home/ilyes/ENV/lib/python3.12/site-packages (from nltk>=3.8) (8.1.8+computecanada)
Requirement already satisfied: joblib in /home/ilyes/ENV/lib/python3.12/site-packages (from nltk>=3.8) (1.5.1+computecanada)
Requirement already satisfied: platformdirs>=2.2.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/ipykernel/2025a/lib/python3.12/site-packages (from pylint>=3.0) (4.3.6+computecanada)
Requirement already satisfied: astroid<=3.1.0-dev0,>=3.0.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from pylint>=3.0) (3.0.3+computecanada)
Requirement already satisfied: isort!=5.13.0,<6,>=4.2.5 in /home/ilyes/ENV/lib/python3.12/site-packages (from pylint>=3.0) (5.13.2+computecanada)
Requirement already satisfied: mccabe<0.8,>=0.6 in /home/ilyes/ENV/lib/python3.12/site-packages (from pylint>=3.0) (0.7.0+computecanada)
Requirement already satisfied: tomlkit>=0.10.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from pylint>=3.0) (0.13.3+computecanada)
Requirement already satisfied: click-option-group==0.5.7 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp>=2.5) (0.5.7)
Requirement already satisfied: docstring-parser<1,>=0.7.3 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp>=2.5) (0.17.0)
Requirement already satisfied: google-api-core!=2.0.*,!=2.1.*,!=2.2.*,!=2.3.0,<3.0.0dev,>=1.31.5 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp>=2.5) (2.25.1)
Requirement already satisfied: google-auth<3,>=1.6.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp>=2.5) (2.40.3)
Requirement already satisfied: google-cloud-storage<4,>=2.2.1 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp>=2.5) (3.2.0)
Requirement already satisfied: kfp-pipeline-spec==2.14.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp>=2.5) (2.14.0)
Requirement already satisfied: kfp-server-api<3,>=2.14.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp>=2.5) (2.14.0)
Requirement already satisfied: kubernetes<31,>=8.0.0 in /home/ilyes/ENV/lib/python3.12/site-packages (from kfp>=2.5) (30.1.0)
INFO: pip is looking at multiple versions of kfp to determine which version is compatible with other requirements. This could take a while.
Collecting kfp>=2.5
  Downloading kfp-2.14.1-py3-none-any.whl.metadata (4.3 kB)
Collecting transformers==4.40.2
  Downloading transformers-4.40.2-py3-none-any.whl.metadata (137 kB)
Collecting protobuf<6,>=5.29
  Downloading protobuf-5.29.5-py3-none-any.whl.metadata (592 bytes)
  Downloading protobuf-5.29.4-py3-none-any.whl.metadata (592 bytes)
INFO: pip is still looking at multiple versions of kfp to determine which version is compatible with other requirements. This could take a while.
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3/protobuf-5.29.3+computecanada-cp312-cp312-linux_x86_64.whl
Collecting protobuf<6,>=5.29
  Downloading protobuf-5.29.3-py3-none-any.whl.metadata (592 bytes)
  Downloading protobuf-5.29.2-py3-none-any.whl.metadata (592 bytes)
INFO: This is taking longer than usual. You might need to provide the dependency resolver with stricter constraints to reduce runtime. See https://pip.pypa.io/warnings/backtracking for guidance. If you want to abort this run, press Ctrl + C.
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3/protobuf-5.29.1+computecanada-cp312-cp312-linux_x86_64.whl
Collecting protobuf<6,>=5.29
  Downloading protobuf-5.29.1-py3-none-any.whl.metadata (592 bytes)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/mccabe-0.7.0+computecanada-py2.py3-none-any.whl (from pylint>=3.0)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/astroid-3.0.3+computecanada-py3-none-any.whl (from pylint>=3.0)
Collecting pylint>=3.0
  Downloading pylint-3.3.8-py3-none-any.whl.metadata (12 kB)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/nltk-3.9.1+computecanada-py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/mpmath-1.3.0+computecanada-py3-none-any.whl (from sympy==1.13.1->torch)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/sympy-1.13.1+computecanada-py3-none-any.whl (from torch)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3/torch-2.7.1+computecanada-cp312-cp312-linux_x86_64.whl
Collecting accelerate>=0.29
  Downloading accelerate-1.10.0-py3-none-any.whl.metadata (19 kB)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/huggingface_hub-0.34.4+computecanada-py3-none-any.whl (from transformers==4.40.2)
Collecting fsspec[http]<=2024.6.1,>=2023.1.0 (from datasets<3,>=2.18)
  Downloading fsspec-2024.6.1-py3-none-any.whl.metadata (11 kB)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/dill-0.3.8+computecanada-py3-none-any.whl (from datasets<3,>=2.18)
Collecting datasets<3,>=2.18
  Downloading datasets-2.21.0-py3-none-any.whl.metadata (21 kB)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic/numpy-1.26.4+computecanada-cp312-cp312-linux_x86_64.whl
ERROR: Cannot install kfp==2.14.1, kfp==2.14.2 and protobuf<6 and >=5.29 because these package versions have conflicting dependencies.

The conflict is caused by:
    The user requested protobuf<6 and >=5.29
    kfp 2.14.2 depends on protobuf<7.0 and ==6.31.1
    kfp 2.14.1 depends on protobuf<7.0 and ==6.31.1

To fix this you could try to:
1. loosen the range of package versions you've specified
2. remove package versions to allow pip to attempt to solve the dependency conflict

ERROR: ResolutionImpossible: for help visit https://pip.pypa.io/en/latest/topics/dependency-resolution/#dealing-with-dependency-conflicts
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ModuleNotFoundError: No module named 'transformers'
Traceback (most recent call last):
  File "/scratch/ilyes/kfp-gen/finetuning/test_qwen/./eval.py", line 14, in <module>
    from transformers import AutoModelForCausalLM, AutoTokenizer
ModuleNotFoundError: No module named 'transformers'
